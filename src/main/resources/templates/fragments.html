<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security">

<head th:fragment="head(title)">
    <meta charset="UTF-8">
    <title th:text="${title} ?: 'FeatureStack'">FeatureStack</title>

    <!-- Tailwind + DaisyUI via CDN -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@3.0.0/dist/full.css" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>

<nav th:fragment="navbar" class="bg-green-700 text-white shadow">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">

        <div class="flex gap-10 items-center">
            <a href="/motos/html" class="text-xl font-bold hover:underline">FeatureStack</a>
            <a href="/motos/html/form" class="hover:underline" th:text="#{motorcycle.new}"></a>
        </div>

        <div class="flex items-center gap-4">
            <!-- Olá, Nome (logado) -->
            <span class="hidden md:inline" sec:authorize="isAuthenticated()">
        Olá,
        <strong
                sec:authentication="principal.attributes['name'] ?: principal.attributes['login'] ?: principal.attributes['given_name'] ?: name">
          usuário
        </strong>
      </span>

            <!-- Entrar (deslogado) -->
            <a class="btn btn-sm btn-outline text-white hover:bg-green-600"
               th:href="@{/login}" sec:authorize="!isAuthenticated()">Entrar</a>

            <!-- Avatar (logado) -->
            <div sec:authorize="isAuthenticated()" tabindex="0" role="button" class="btn btn-ghost btn-circle avatar">
                <div class="w-10 rounded-full">
                    <img alt="Avatar do usuário"
                         th:src="${#authentication.principal.attributes['avatar_url'] ?: #authentication.principal.attributes['picture'] ?: '/img/avatar-default.png'}"/>
                </div>
            </div>

            <!-- Sair -->
            <form th:action="@{/logout}" method="post" sec:authorize="isAuthenticated()">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <button class="btn btn-sm btn-warning">Sair</button>
            </form>

            <!-- Idioma -->
            <div class="dropdown dropdown-end">
                <label tabindex="0" class="btn btn-sm btn-outline text-white hover:bg-green-600">🌎</label>
                <ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-white text-black rounded w-40">
                    <li><a href="?lang=pt-BR">🇧🇷 Português</a></li>
                    <li><a href="?lang=en">🇺🇸 English</a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>

<footer th:fragment="footer" class="mt-auto bg-green-100 text-center text-sm text-gray-700 p-4">
    <p>FeatureStack</p>
</footer>

</body>
</html>
